{"version":3,"sources":["web/js/KurentoVideoConsumer.ts"],"names":["KurentoVideoConsumer","KurentoVideoConsumer.constructor","KurentoVideoConsumer.playStream","KurentoVideoConsumer.dispose"],"mappings":"AACA,IAAO,eAAe,WAAW,8BAA8B,CAAC,CAAC;AACjE,IAAO,gBAAgB,WAAW,oBAAoB,CAAC,CAAC;AACxD,IAAO,aAAa,WAAW,iBAAiB,CAAC,CAAC;AAElD;IAEIA,8BAAYA,gBAAwBA,EAAEA,MAAyBA;QAAzBC,sBAAyBA,GAAzBA,gBAAyBA;QAOvDA,QAAGA,GAAqBA,IAAIA,CAACA;QANjCA,IAAIA,CAACA,MAAMA,GAAGA,MAAMA,CAACA;QAErBA,IAAIA,CAACA,GAAGA,GAAGA,IAAIA,gBAAgBA,CAACA,oBAAoBA,CAACA,cAAcA,EAAEA,gBAAgBA,EAAEA,MAAMA,CAACA,CAACA;IACnGA,CAACA;IAKMD,yCAAUA,GAAjBA,UAAkBA,SAAiBA;QAAnCE,iBAaCA;QAZGA,IAAIA,OAAqBA,CAACA;QAC1BA,EAAEA,CAACA,CAACA,IAAIA,CAACA,GAAGA,CAACA,KAAKA,IAAIA,eAAeA,CAACA,UAAUA,CAACA,CAACA,CAACA;YAC/CA,OAAOA,GAAGA,IAAIA,CAACA,GAAGA,CAACA,KAAKA,EAAEA,CAAAA;QAC9BA,CAACA;QAACA,IAAIA;YACFA,OAAOA,GAAGA,OAAOA,CAACA,OAAOA,EAAEA,CAACA;QAChCA,MAAMA,CAACA,OAAOA,CAACA,IAAIA,CAACA;YAChBA,KAAIA,CAACA,GAAGA,CAACA,QAAQA,EAAEA,CAACA,IAAIA,CAACA,UAAAA,CAACA;gBACtBA,QAAQA,CAACA;gBACTA,KAAIA,CAACA,MAAMA,CAACA,GAAGA,CAACA,2BAA2BA,GAAIA,CAACA,CAACA,CAACA;YACtDA,CAACA,CAACA,CAACA;YACHA,MAAMA,CAACA,IAAIA,aAAaA,CAACA,EAAEA,CAACA,CAACA;QACjCA,CAACA,CAACA,CAACA;IACPA,CAACA;IAEMF,sCAAOA,GAAdA;QACIG,IAAIA,CAACA,GAAGA,CAACA,IAAIA,EAAEA,CAACA;IACpBA,CAACA;IAEcH,mCAAcA,GAAGA;QAC5BA,MAAMA,EAAEA,KAAKA;QACbA,UAAUA,EAAEA;YACRA,MAAMA,EAAEA,KAAKA;YACbA,MAAMA,EAAEA,IAAIA;SACfA;QACDA,OAAOA,EAAEA;YACLA,GAAGA,EAAEA;gBACDA,MAAMA,EAAEA,QAAQA;gBAChBA,WAAWA,EAAEA,QAAQA;aACxBA;YACDA,IAAIA,EAAEA;gBACFA,MAAMA,EAAEA,WAAWA;aACtBA;YACDA,YAAYA,EAAEA;gBACVA,MAAMA,EAAEA,WAAWA;gBACnBA,MAAMA,EAAEA;oBACJA,SAASA,EAAEA;wBACPA,MAAMA,EAAEA,QAAQA;wBAChBA,OAAOA,EAAEA;4BACLA,YAAYA,EAAEA;gCACVA,QAAQA,EAAEA,SAASA;gCACnBA,MAAMA,EAAEA,YAAYA;6BACvBA;4BACDA,eAAeA,EAAEA;gCACbA,QAAQA,EAAEA,0BAA0BA;gCACpCA,MAAMA,EAAEA,eAAeA;gCACvBA,MAAMA,EAAEA,SAASA;gCACjBA,YAAYA,EAAEA,GAAGA;gCACjBA,QAAQA,EAAEA,EAAEA;6BACfA;yBACJA;qBACJA;iBACJA;aACJA;SACJA;KACJA,CAACA;IAENA,2BAACA;AAADA,CApEA,AAoECA,IAAA;AAED,iBAAS,oBAAoB,CAAC","file":"web/js/KurentoVideoConsumer.js","sourcesContent":["\r\nimport ConnectionState = require('../../server/ConnectionState');\r\nimport KurentoClientHub = require('./KurentoHubClient');\r\nimport KurentoPlayer = require('./KurentoPlayer');\r\n\r\nclass KurentoVideoConsumer {\r\n\r\n    constructor(kurentoHubDomain: string, logger: Console = console) {\r\n        this.logger = logger;\r\n\r\n        this.hub = new KurentoClientHub(KurentoVideoConsumer.crossbarConfig, kurentoHubDomain, logger);\r\n    }\r\n\r\n    private logger: Console;\r\n    private hub: KurentoClientHub = null;\r\n\r\n    public playStream(streamUrl: string): Promise<KurentoPlayer> {\r\n        var promise: Promise<any>;\r\n        if (this.hub.state == ConnectionState.NotCreated) {\r\n            promise = this.hub.start()\r\n        } else\r\n            promise = Promise.resolve();\r\n        return promise.then(() => {\r\n            this.hub.register().then(r => {\r\n                debugger;\r\n                this.logger.log('RPC \"register\" response: ' +  r);\r\n            });\r\n            return new KurentoPlayer('');\r\n        });\r\n    }\r\n\r\n    public dispose(): void {\r\n        this.hub.stop();\r\n    }\r\n\r\n    private static crossbarConfig = {\r\n        \"type\": \"web\",\r\n        \"endpoint\": {\r\n            \"type\": \"tcp\",\r\n            \"port\": 8080\r\n        },\r\n        \"paths\": {\r\n            \"/\": {\r\n                \"type\": \"static\",\r\n                \"directory\": \"../web\"\r\n            },\r\n            \"ws\": {\r\n                \"type\": \"websocket\"\r\n            },\r\n            \"kurentoHub\": {\r\n                \"type\": \"websocket\",\r\n                \"auth\": {\r\n                    \"wampcra\": {\r\n                        \"type\": \"static\",\r\n                        \"users\": {\r\n                            \"KurentoHub\": {\r\n                                \"secret\": \"secret2\",\r\n                                \"role\": \"KurentoHub\"\r\n                            },\r\n                            \"VideoConsumer\": {\r\n                                \"secret\": \"prq7+YkJ1/KlW1X0YczMHw==\",\r\n                                \"role\": \"VideoConsumer\",\r\n                                \"salt\": \"salt123\",\r\n                                \"iterations\": 100,\r\n                                \"keylen\": 16\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n}\r\n\r\nexport = KurentoVideoConsumer;"],"sourceRoot":"../"}